### Организация коммуникции узлов




пишем свою операцию редукции среди чисел кратных 10 а потом и прочих чисел

пересылка квадратной матрицы так, что она транспонируется



Данная программа написана на языке C с использованием библиотеки MPI (Message Passing Interface) и демонстрирует основы параллельного программирования, включая создание пользовательских операций, распределение данных и их редукцию. Вот основные компоненты и функции программы, а также её назначение:

### Основные компоненты программы

1. **Определение констант и функций**:
   - Программа определяет размер массива для передачи данных, равный 1024 (`#define SIZE 1024`).
   - Используется пользовательская функция `sum_element10`, которая осуществляет сложение элементов двух массивов. При этом, если элемент не кратен 10, он обнуляется перед суммированием.

2. **Инициализация MPI**:
   - В функции `main` происходит инициализация MPI с помощью `MPI_Init`, что необходимо для работы с распределёнными процессами.
   - Получение информации о процессах (номер ранга и общее количество процессов) осуществляется через функции `MPI_Comm_size` и `MPI_Comm_rank`.
   - Получение имени процессора происходит через `MPI_Get_processor_name`.

3. **Проверка количества процессов**:
   - Если число процессов менее 2, программа выводит сообщение об ошибке и завершает выполнение.

4. **Распределение данных**:
   - Процесс с рангом 1 выделяет память и инициализирует массив четными числами, который затем распределяется между всеми процессами с помощью `MPI_Scatter`.
   - Остальные процессы, кроме процесса с рангом 1, не выделяют память для буфера и получают `NULL`.

5. **Редукция данных**:
   - С помощью операции редукции `MPI_Reduce` происходит суммирование элементов массивов всех процессов. Результаты собираются в массиве процесса с рангом 0.
   - Используется пользовательская операция сложения, которая изменяет только элементы, кратные 10.

6. **Вывод результатов**:
   - Каждый процесс выводит свои данные, а процесс с рангом 0 выводит результаты редукции.

7. **Завершение работы MPI**:
   - Программа завершается вызовом `MPI_Finalize`, что освобождает ресурсы, связанные с MPI.

### Объяснение вывода

1. **Сообщения от процессов**:
   ```
   Hello from processor h181.net55.bmstu.ru[19] 0 of 3  
   Hello from processor h181.net55.bmstu.ru[19] 2 of 3  
   Hello from processor h181.net55.bmstu.ru[19] 1 of 3  
   ```
   Эти строки показывают, что каждый из трёх процессов (с номерами 0, 1 и 2) успешно инициализировался и вывел своё сообщение. Это каждый из процессов сообщает о себе: имя процессора, номер процесса и общее их количество (3).

2. **Вывод содержимого буфера `buf`**:
   ```
   My[ 1]    Buf[ 0] =         0        2        4 ...
   My[ 1]    Buf[ 1] =      2048     2050     2052 ...
   My[ 1]    Buf[ 2] =      4096     4098     4100 ...
   ```
   Здесь видно, что процесс с рангом 1 инициализирует буфер `buf`. В этом буфере хранятся четные числа, начиная с 0. Процесс 1 выводит первые несколько значений для каждой секции (раздела) буфера, куда входные данные разбиваются по всем процессам. Каждый процесс будет получать массив длиной `SIZE` из общего буфера, поэтому вывод отображает именно его содержимое.

3. **Вывод полученных данных (выходной буфер)**:
   ```
   My[ 0] outBuf =        0        2        4 ...
   My[ 2] outBuf =     4096     4098     4100 ...
   My[ 1] outBuf =     2048     2050     2052 ...
   ```
   Каждый процесс выводит свои данные из `outbuf`, полученные с помощью функции `MPI_Scatter`. Процесс 0 получает первые три значения (0, 2, 4), процесс 1 получает следующие (2048, 2050, 2052), а процесс 2 – последние (4096, 4098, 4100).

4. **Вывод результата редукции**:
   ```
   My[ 0] redBuf =        0     2050     4100 ...
   ```
   Это результат операции редукции, выполненной с помощью `MPI_Reduce`. Процесс 0 получает из `outbuf` результаты по правилам, заданным в функции `sum_element10`. В этом процессе каждый элемент `outbuf` проверяется на кратность 10. Если не кратен, ему присваивается значение 0. Это может объяснить некоторые значения в `redBuf` – многие из них могут быть обнулены, либо результатом будет сложение оставшихся значений.

### Возможные Ошибки или Неясности

- **Обнуление значений**:
  Если элемент в любом из массивов не кратен 10, то он обнулится в функции `sum_element10`, используемой для редукции. Поэтому итоговые значения могут вас удивить. Например, если `outBuf` на каких-то позициях содержит числа, не кратные 10, это может вести к получению 0 в итоговом `redBuf`.

- **Корректность использования MPI**:
  Важно всегда проверять, что выделенная память соответствует ожидаемым значениям. Не забывайте очищать память и следить за инициализацией массивов для избежания неопределённых значений.

### Заключение

Суммируя всё вышеуказанное, вывод вашей программы правильно интерпретирует данные о текущих процессах, содержимом их буферов и результатах редукции. Выводит значения и их обработку в зависимости от кратности 10, что может свести результаты итогового массива `redBuf` к нулям, если исходные значения окажутся не кратны 10.